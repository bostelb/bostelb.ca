(function(e){"use strict";var t={};var n=function(e){var r,i,s,o,u,a;n.classes.dispatcher.extend(this);var f=this,l=e||{};if(typeof l==="string"||l instanceof HTMLElement)l={renderers:[l]};else if(Object.prototype.toString.call(l)==="[object Array]")l={renderers:l};u=l.renderers||l.renderer||l.container;if(!l.renderers||l.renderers.length===0)if(typeof u==="string"||u instanceof HTMLElement||typeof u==="object"&&"container"in u)l.renderers=[u];if(l.id){if(t[l.id])throw'sigma: Instance "'+l.id+'" already exists.';Object.defineProperty(this,"id",{value:l.id})}else{a=0;while(t[a])a++;Object.defineProperty(this,"id",{value:""+a})}t[this.id]=this;this.settings=new n.classes.configurable(n.settings,l.settings||{});Object.defineProperty(this,"graph",{value:new n.classes.graph(this.settings),configurable:true});Object.defineProperty(this,"middlewares",{value:[],configurable:true});Object.defineProperty(this,"cameras",{value:{},configurable:true});Object.defineProperty(this,"renderers",{value:{},configurable:true});Object.defineProperty(this,"renderersPerCamera",{value:{},configurable:true});Object.defineProperty(this,"cameraFrames",{value:{},configurable:true});Object.defineProperty(this,"camera",{get:function(){return this.cameras[0]}});Object.defineProperty(this,"events",{value:["click","rightClick","clickStage","doubleClickStage","rightClickStage","clickNode","clickNodes","doubleClickNode","doubleClickNodes","rightClickNode","rightClickNodes","overNode","overNodes","outNode","outNodes","downNode","downNodes","upNode","upNodes"],configurable:true});this._handler=function(e){var t,n={};for(t in e.data)n[t]=e.data[t];n.renderer=e.target;this.dispatchEvent(e.type,n)}.bind(this);s=l.renderers||[];for(r=0,i=s.length;r<i;r++)this.addRenderer(s[r]);s=l.middlewares||[];for(r=0,i=s.length;r<i;r++)this.middlewares.push(typeof s[r]==="string"?n.middlewares[s[r]]:s[r]);if(typeof l.graph==="object"&&l.graph){this.graph.read(l.graph);this.refresh()}window.addEventListener("resize",function(){if(f.settings)f.refresh()})};n.prototype.addCamera=function(t){var r=this,i;if(!arguments.length){t=0;while(this.cameras[""+t])t++;t=""+t}if(this.cameras[t])throw'sigma.addCamera: The camera "'+t+'" already exists.';i=new n.classes.camera(t,this.graph,this.settings);this.cameras[t]=i;i.quadtree=new n.classes.quad;if(n.classes.edgequad!==e){i.edgequadtree=new n.classes.edgequad}i.bind("coordinatesUpdated",function(e){r.renderCamera(i,i.isAnimated)});this.renderersPerCamera[t]=[];return i};n.prototype.killCamera=function(e){e=typeof e==="string"?this.cameras[e]:e;if(!e)throw"sigma.killCamera: The camera is undefined.";var t,n,r=this.renderersPerCamera[e.id];for(n=r.length,t=n-1;t>=0;t--)this.killRenderer(r[t]);delete this.renderersPerCamera[e.id];delete this.cameraFrames[e.id];delete this.cameras[e.id];if(e.kill)e.kill();return this};n.prototype.addRenderer=function(e){var t,r,i,s,o=e||{};if(typeof o==="string")o={container:document.getElementById(o)};else if(o instanceof HTMLElement)o={container:o};if(typeof o.container==="string")o.container=document.getElementById(o.container);if(!("id"in o)){t=0;while(this.renderers[""+t])t++;t=""+t}else t=o.id;if(this.renderers[t])throw'sigma.addRenderer: The renderer "'+t+'" already exists.';r=typeof o.type==="function"?o.type:n.renderers[o.type];r=r||n.renderers.def;i="camera"in o?o.camera instanceof n.classes.camera?o.camera:this.cameras[o.camera]||this.addCamera(o.camera):this.addCamera();if(this.cameras[i.id]!==i)throw"sigma.addRenderer: The camera is not properly referenced.";s=new r(this.graph,i,this.settings,o);this.renderers[t]=s;Object.defineProperty(s,"id",{value:t});if(s.bind)s.bind(["click","rightClick","clickStage","doubleClickStage","rightClickStage","clickNode","clickNodes","clickEdge","clickEdges","doubleClickNode","doubleClickNodes","doubleClickEdge","doubleClickEdges","rightClickNode","rightClickNodes","rightClickEdge","rightClickEdges","overNode","overNodes","overEdge","overEdges","outNode","outNodes","outEdge","outEdges","downNode","downNodes","downEdge","downEdges","upNode","upNodes","upEdge","upEdges"],this._handler);this.renderersPerCamera[i.id].push(s);return s};n.prototype.killRenderer=function(e){e=typeof e==="string"?this.renderers[e]:e;if(!e)throw"sigma.killRenderer: The renderer is undefined.";var t=this.renderersPerCamera[e.camera.id],n=t.indexOf(e);if(n>=0)t.splice(n,1);if(e.kill)e.kill();delete this.renderers[e.id];return this};n.prototype.refresh=function(t){var r,i,s,o,u,a,f=0;t=t||{};o=this.middlewares||[];for(r=0,i=o.length;r<i;r++)o[r].call(this,r===0?"":"tmp"+f+":",r===i-1?"ready:":"tmp"+ ++f+":");for(s in this.cameras){u=this.cameras[s];if(u.settings("autoRescale")&&this.renderersPerCamera[u.id]&&this.renderersPerCamera[u.id].length)n.middlewares.rescale.call(this,o.length?"ready:":"",u.readPrefix,{width:this.renderersPerCamera[u.id][0].width,height:this.renderersPerCamera[u.id][0].height});else n.middlewares.copy.call(this,o.length?"ready:":"",u.readPrefix);if(!t.skipIndexation){a=n.utils.getBoundaries(this.graph,u.readPrefix);u.quadtree.index(this.graph.nodes(),{prefix:u.readPrefix,bounds:{x:a.minX,y:a.minY,width:a.maxX-a.minX,height:a.maxY-a.minY}});if(u.edgequadtree!==e&&u.settings("drawEdges")&&u.settings("enableEdgeHovering")){u.edgequadtree.index(this.graph,{prefix:u.readPrefix,bounds:{x:a.minX,y:a.minY,width:a.maxX-a.minX,height:a.maxY-a.minY}})}}}o=Object.keys(this.renderers);for(r=0,i=o.length;r<i;r++)if(this.renderers[o[r]].process){if(this.settings("skipErrors"))try{this.renderers[o[r]].process()}catch(l){console.log('Warning: The renderer "'+o[r]+'" crashed on ".process()"')}else this.renderers[o[r]].process()}this.render();return this};n.prototype.render=function(){var e,t,n,r=0;n=Object.keys(this.renderers);for(e=0,t=n.length;e<t;e++)if(this.settings("skipErrors"))try{this.renderers[n[e]].render()}catch(i){if(this.settings("verbose"))console.log('Warning: The renderer "'+n[e]+'" crashed on ".render()"')}else this.renderers[n[e]].render();return this};n.prototype.renderCamera=function(e,t){var n,r,i,s=this;if(t){i=this.renderersPerCamera[e.id];for(n=0,r=i.length;n<r;n++)if(this.settings("skipErrors"))try{i[n].render()}catch(o){if(this.settings("verbose"))console.log('Warning: The renderer "'+i[n].id+'" crashed on ".render()"')}else i[n].render()}else{if(!this.cameraFrames[e.id]){i=this.renderersPerCamera[e.id];for(n=0,r=i.length;n<r;n++)if(this.settings("skipErrors"))try{i[n].render()}catch(o){if(this.settings("verbose"))console.log('Warning: The renderer "'+i[n].id+'" crashed on ".render()"')}else i[n].render();this.cameraFrames[e.id]=requestAnimationFrame(function(){delete s.cameraFrames[e.id]})}}return this};n.prototype.kill=function(){var e;this.dispatchEvent("kill");this.graph.kill();delete this.middlewares;for(e in this.renderers)this.killRenderer(this.renderers[e]);for(e in this.cameras)this.killCamera(this.cameras[e]);delete this.renderers;delete this.cameras;for(e in this)if(this.hasOwnProperty(e))delete this[e];delete t[this.id]};n.instances=function(e){return arguments.length?t[e]:n.utils.extend({},t)};n.version="1.0.3";if(typeof this.sigma!=="undefined")throw"An object called sigma is already in the global scope.";this.sigma=n}).call(this);(function(e){"use strict";function c(e,t){var n,r,i,s;if(!arguments.length)return;else if(arguments.length===1&&Object(arguments[0])===arguments[0])for(e in arguments[0])c(e,arguments[0][e]);else if(arguments.length>1){s=Array.isArray(e)?e:e.split(/ /);for(n=0,r=s.length;n!==r;n+=1){i=s[n];if(!l[i])l[i]=[];l[i].push({handler:t})}}}function h(e,t){var n,r,i,s,o,u,a=Array.isArray(e)?e:e.split(/ /);if(!arguments.length)l=Object.create(null);else if(t){for(n=0,r=a.length;n!==r;n+=1){u=a[n];if(l[u]){o=[];for(i=0,s=l[u].length;i!==s;i+=1)if(l[u][i].handler!==t)o.push(l[u][i]);l[u]=o}if(l[u]&&l[u].length===0)delete l[u]}}else for(n=0,r=a.length;n!==r;n+=1)delete l[a[n]]}function p(e,t){var n,r,i,s,o,u,a=Array.isArray(e)?e:e.split(/ /);t=t===undefined?{}:t;for(n=0,i=a.length;n!==i;n+=1){u=a[n];if(l[u]){o={type:u,data:t||{}};for(r=0,s=l[u].length;r!==s;r+=1)try{l[u][r].handler(o)}catch(f){}}}}function d(){var e,t,n,r,i=false,o=L(),u=s.shift();n=u.job();o=L()-o;u.done++;u.time+=o;u.currentTime+=o;u.weightTime=u.currentTime/(u.weight||1);u.averageTime=u.time/u.done;r=u.count?u.count<=u.done:!n;if(!r){for(e=0,t=s.length;e<t;e++)if(s[e].weightTime>u.weightTime){s.splice(e,0,u);i=true;break}if(!i)s.push(u)}return r?u:null}function v(e){var t=s.length;i[e.id]=e;e.status="running";if(t){e.weightTime=s[t-1].weightTime;e.currentTime=e.weightTime*(e.weight||1)}e.startTime=L();p("jobStarted",C(e));s.push(e)}function m(){var e,i,u,a,l,c;for(e in r){a=r[e];if(a.after)o[e]=a;else v(a);delete r[e]}n=!!s.length;while(s.length&&L()-t<f.frameDuration){c=d();if(c){y(c.id);for(e in o)if(o[e].after===c.id){v(o[e]);delete o[e]}}}if(n){t=L();p("enterFrame");setTimeout(m,0)}else p("stop")}function g(e,i){var s,o,u;if(Array.isArray(e)){a=true;for(s=0,o=e.length;s<o;s++)g(e[s].id,N(e[s],i));a=false;if(!n){t=L();p("start");m()}}else if(typeof e==="object"){if(typeof e.id==="string")g(e.id,e);else{a=true;for(s in e)if(typeof e[s]==="function")g(s,N({job:e[s]},i));else g(s,N(e[s],i));a=false;if(!n){t=L();p("start");m()}}}else if(typeof e==="string"){if(w(e))throw new Error('[conrad.addJob] Job with id "'+e+'" already exists.');if(typeof i==="function"){u={id:e,done:0,time:0,status:"waiting",currentTime:0,averageTime:0,weightTime:0,job:i}}else if(typeof i==="object"){u=N({id:e,done:0,time:0,status:"waiting",currentTime:0,averageTime:0,weightTime:0},i)}else throw new Error("[conrad.addJob] Wrong arguments.");r[e]=u;p("jobAdded",C(u));if(!n&&!a){t=L();p("start");m()}}else throw new Error("[conrad.addJob] Wrong arguments.");return this}function y(e){var t,n,a,l,c,h=false;if(Array.isArray(e))for(t=0,n=e.length;t<n;t++)y(e[t]);else if(typeof e==="string"){l=[i,o,r];for(t=0,n=l.length;t<n;t++)if(e in l[t]){c=l[t][e];if(f.history){c.status="done";u.push(c)}p("jobEnded",C(c));delete l[t][e];if(typeof c.end==="function")c.end();h=true}l=s;for(t=0,n=l.length;t<n;t++)if(l[t].id===e){l.splice(t,1);break}if(!h)throw new Error('[conrad.killJob] Job "'+e+'" not found.')}else throw new Error("[conrad.killJob] Wrong arguments.");return this}function b(){var e,t=N(r,i,o);if(f.history)for(e in t){t[e].status="done";u.push(t[e]);if(typeof t[e].end==="function")t[e].end()}r={};o={};i={};s=[];n=false;return this}function w(e){var t=r[e]||i[e]||o[e];return t?N(t):null}function E(e,t){var n;if(typeof a1==="string"&&arguments.length===1)return f[a1];else{n=typeof a1==="object"&&arguments.length===1?a1||{}:{};if(typeof a1==="string")n[a1]=a2;for(var r in n)if(n[r]!==undefined)f[r]=n[r];else delete f[r];return this}}function S(){return n}function x(){u=[];return this}function T(e,t){var n,s,a,f,l,c,h;if(!arguments.length){l=[];for(s in r)l.push(r[s]);for(s in o)l.push(o[s]);for(s in i)l.push(i[s]);l=l.concat(u)}if(typeof e==="string")switch(e){case"waiting":l=k(o);break;case"running":l=k(i);break;case"done":l=u;break;default:c=e}if(e instanceof RegExp)c=e;if(!c&&(typeof t==="string"||t instanceof RegExp))c=t;if(c){h=typeof c==="string";if(l instanceof Array){n=l}else if(typeof l==="object"){n=[];for(s in l)n=n.concat(l[s])}else{n=[];for(s in r)n.push(r[s]);for(s in o)n.push(o[s]);for(s in i)n.push(i[s]);n=n.concat(u)}l=[];for(a=0,f=n.length;a<f;a++)if(h?n[a].id===c:n[a].id.match(c))l.push(n[a])}return C(l)}function N(){var e,t,n={},r=arguments.length;for(e=r-1;e>=0;e--)for(t in arguments[e])n[t]=arguments[e][t];return n}function C(e){var t,n,r,i;if(!e)return e;if(Array.isArray(e)){t=[];for(n=0,i=e.length;n<i;n++)t.push(C(e[n]))}else if(typeof e==="object"){t={};for(n in e)t[n]=C(e[n])}else t=e;return t}function k(e){var t,n=[];for(t in e)n.push(e[t]);return n}function L(){return Date.now?Date.now():(new Date).getTime()}if(e.conrad)throw new Error("conrad already exists");var t;var n=false;var r={};var i={};var s=[];var o={};var u=[];var a=false;var f={frameDuration:20,history:true};var l=Object.create(null);if(!Array.isArray)Array.isArray=function(e){return Object.prototype.toString.call(e)==="[object Array]"};var A={hasJob:w,addJob:g,killJob:y,killAll:b,settings:E,getStats:T,isRunning:S,clearHistory:x,bind:c,unbind:h,version:"0.1.0"};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports)exports=module.exports=A;exports.conrad=A}e.conrad=A})(this);(function(e){"use strict";if(typeof sigma==="undefined")throw"sigma is not declared";var t=this;sigma.utils=sigma.utils||{};sigma.utils.extend=function(){var e,t,n={},r=arguments.length;for(e=r-1;e>=0;e--)for(t in arguments[e])n[t]=arguments[e][t];return n};sigma.utils.dateNow=function(){return Date.now?Date.now():(new Date).getTime()};sigma.utils.pkg=function(e){return(e||"").split(".").reduce(function(e,t){return t in e?e[t]:e[t]={}},t)};sigma.utils.id=function(){var e=0;return function(){return++e}}();sigma.utils.floatColor=function(e){var t=[0,0,0];if(e.match(/^#/)){e=(e||"").replace(/^#/,"");t=e.length===3?[parseInt(e.charAt(0)+e.charAt(0),16),parseInt(e.charAt(1)+e.charAt(1),16),parseInt(e.charAt(2)+e.charAt(2),16)]:[parseInt(e.charAt(0)+e.charAt(1),16),parseInt(e.charAt(2)+e.charAt(3),16),parseInt(e.charAt(4)+e.charAt(5),16)]}else if(e.match(/^ *rgba? *\(/)){e=e.match(/^ *rgba? *\( *([0-9]*) *, *([0-9]*) *, *([0-9]*) *(,.*)?\) *$/);t=[+e[1],+e[2],+e[3]]}return t[0]*256*256+t[1]*256+t[2]};sigma.utils.zoomTo=function(e,t,n,r,i){var s=e.settings,o,u,a,f;u=Math.max(s("zoomMin"),Math.min(s("zoomMax"),e.ratio*r));if(u!==e.ratio){r=u/e.ratio;f={x:t*(1-r)+e.x,y:n*(1-r)+e.y,ratio:u};if(i&&i.duration){o=sigma.misc.animation.killAll(e);i=sigma.utils.extend(i,{easing:o?"quadraticOut":"quadraticInOut"});sigma.misc.animation.camera(e,f,i)}else{e.goTo(f);if(i&&i.onComplete)i.onComplete()}}};sigma.utils.getQuadraticControlPoint=function(e,t,n,r){return{x:(e+n)/2+(r-t)/4,y:(t+r)/2+(e-n)/4}};sigma.utils.getPointOnQuadraticCurve=function(e,t,n,r,i,s,o){return{x:Math.pow(1-e,2)*t+2*(1-e)*e*s+Math.pow(e,2)*r,y:Math.pow(1-e,2)*n+2*(1-e)*e*o+Math.pow(e,2)*i}};sigma.utils.getPointOnBezierCurve=function(e,t,n,r,i,s,o,u,a){var f=Math.pow(1-e,3),l=3*e*Math.pow(1-e,2),c=3*Math.pow(e,2)*(1-e),h=Math.pow(e,3);return{x:f*t+l*s+c*u+h*r,y:f*n+l*o+c*a+h*i}};sigma.utils.getSelfLoopControlPoints=function(e,t,n){return{x1:e-n*7,y1:t,x2:e,y2:t+n*7}};sigma.utils.getDistance=function(e,t,n,r){return Math.sqrt(Math.pow(n-e,2)+Math.pow(r-t,2))};sigma.utils.getCircleIntersection=function(e,t,n,r,i,s){var o,u,a,f,l,c,h,p,d;u=r-e;a=i-t;f=Math.sqrt(a*a+u*u);if(f>n+s){return false}if(f<Math.abs(n-s)){return false}o=(n*n-s*s+f*f)/(2*f);p=e+u*o/f;d=t+a*o/f;l=Math.sqrt(n*n-o*o);c=-a*(l/f);h=u*(l/f);var v=p+c;var m=p-c;var g=d+h;var y=d-h;return{xi:v,xi_prime:m,yi:g,yi_prime:y}};sigma.utils.isPointOnSegment=function(e,t,n,r,i,s,o){var u=Math.abs((t-r)*(i-n)-(e-n)*(s-r)),a=sigma.utils.getDistance(n,r,i,s),f=u/a;return f<o&&Math.min(n,i)<=e&&e<=Math.max(n,i)&&Math.min(r,s)<=t&&t<=Math.max(r,s)};sigma.utils.isPointOnQuadraticCurve=function(e,t,n,r,i,s,o,u,a){var f=sigma.utils.getDistance(n,r,i,s);if(Math.abs(e-n)>f||Math.abs(t-r)>f){return false}var l=sigma.utils.getDistance(e,t,n,r),c=sigma.utils.getDistance(e,t,i,s),h=.5,p=l<c?-.01:.01,d=.001,v=100,m=sigma.utils.getPointOnQuadraticCurve(h,n,r,i,s,o,u),g=sigma.utils.getDistance(e,t,m.x,m.y),y;while(v-->0&&h>=0&&h<=1&&g>a&&(p>d||p<-d)){y=g;m=sigma.utils.getPointOnQuadraticCurve(h,n,r,i,s,o,u);g=sigma.utils.getDistance(e,t,m.x,m.y);if(g>y){p=-p/2;h+=p}else if(h+p<0||h+p>1){p=p/2;g=y}else{h+=p}}return g<a};sigma.utils.isPointOnBezierCurve=function(e,t,n,r,i,s,o,u,a,f,l){var c=sigma.utils.getDistance(n,r,o,u);if(Math.abs(e-n)>c||Math.abs(t-r)>c){return false}var h=sigma.utils.getDistance(e,t,n,r),p=sigma.utils.getDistance(e,t,i,s),d=.5,v=h<p?-.01:.01,m=.001,g=100,y=sigma.utils.getPointOnBezierCurve(d,n,r,i,s,o,u,a,f),b=sigma.utils.getDistance(e,t,y.x,y.y),w;while(g-->0&&d>=0&&d<=1&&b>l&&(v>m||v<-m)){w=b;y=sigma.utils.getPointOnBezierCurve(d,n,r,i,s,o,u,a,f);b=sigma.utils.getDistance(e,t,y.x,y.y);if(b>w){v=-v/2;d+=v}else if(d+v<0||d+v>1){v=v/2;b=w}else{d+=v}}return b<l};sigma.utils.getX=function(t){return t.offsetX!==e&&t.offsetX||t.layerX!==e&&t.layerX||t.clientX!==e&&t.clientX};sigma.utils.getY=function(t){return t.offsetY!==e&&t.offsetY||t.layerY!==e&&t.layerY||t.clientY!==e&&t.clientY};sigma.utils.getWidth=function(t){var n=!t.target.ownerSVGElement?t.target.width:t.target.ownerSVGElement.width;return typeof n==="number"&&n||n!==e&&n.baseVal!==e&&n.baseVal.value};sigma.utils.getHeight=function(t){var n=!t.target.ownerSVGElement?t.target.height:t.target.ownerSVGElement.height;return typeof n==="number"&&n||n!==e&&n.baseVal!==e&&n.baseVal.value};sigma.utils.getDelta=function(t){return t.wheelDelta!==e&&t.wheelDelta||t.detail!==e&&-t.detail};sigma.utils.getOffset=function(e){var t=0,n=0;while(e){n=n+parseInt(e.offsetTop);t=t+parseInt(e.offsetLeft);e=e.offsetParent}return{top:n,left:t}};sigma.utils.doubleClick=function(e,t,n){var r=0,i=this,s;e._doubleClickHandler=e._doubleClickHandler||{};e._doubleClickHandler[t]=e._doubleClickHandler[t]||[];s=e._doubleClickHandler[t];s.push(function(e){r++;if(r===2){r=0;return n(e)}else if(r===1){setTimeout(function(){r=0},sigma.settings.doubleClickTimeout)}});e.addEventListener(t,s[s.length-1],false)};sigma.utils.unbindDoubleClick=function(e,t){var n,r=(e._doubleClickHandler||{})[t]||[];while(n=r.pop()){e.removeEventListener(t,n)}delete (e._doubleClickHandler||{})[t]};sigma.utils.easings=sigma.utils.easings||{};sigma.utils.easings.linearNone=function(e){return e};sigma.utils.easings.quadraticIn=function(e){return e*e};sigma.utils.easings.quadraticOut=function(e){return e*(2-e)};sigma.utils.easings.quadraticInOut=function(e){if((e*=2)<1)return.5*e*e;return-.5*(--e*(e-2)-1)};sigma.utils.easings.cubicIn=function(e){return e*e*e};sigma.utils.easings.cubicOut=function(e){return--e*e*e+1};sigma.utils.easings.cubicInOut=function(e){if((e*=2)<1)return.5*e*e*e;return.5*((e-=2)*e*e+2)};sigma.utils.loadShader=function(e,t,n,r){var i,s=e.createShader(n);e.shaderSource(s,t);e.compileShader(s);i=e.getShaderParameter(s,e.COMPILE_STATUS);if(!i){if(r){r('Error compiling shader "'+s+'":'+e.getShaderInfoLog(s))}e.deleteShader(s);return null}return s};sigma.utils.loadProgram=function(e,t,n,r,i){var s,o,u=e.createProgram();for(s=0;s<t.length;++s)e.attachShader(u,t[s]);if(n)for(s=0;s<n.length;++s)e.bindAttribLocation(u,locations?locations[s]:s,opt_attribs[s]);e.linkProgram(u);o=e.getProgramParameter(u,e.LINK_STATUS);if(!o){if(i)i("Error in program linking: "+e.getProgramInfoLog(u));e.deleteProgram(u);return null}return u};sigma.utils.pkg("sigma.utils.matrices");sigma.utils.matrices.translation=function(e,t){return[1,0,0,0,1,0,e,t,1]};sigma.utils.matrices.rotation=function(e,t){var n=Math.cos(e),r=Math.sin(e);return t?[n,-r,r,n]:[n,-r,0,r,n,0,0,0,1]};sigma.utils.matrices.scale=function(e,t){return t?[e,0,0,e]:[e,0,0,0,e,0,0,0,1]};sigma.utils.matrices.multiply=function(e,t,n){var r=n?2:3,i=e[0*r+0],s=e[0*r+1],o=e[0*r+2],u=e[1*r+0],a=e[1*r+1],f=e[1*r+2],l=e[2*r+0],c=e[2*r+1],h=e[2*r+2],p=t[0*r+0],d=t[0*r+1],v=t[0*r+2],m=t[1*r+0],g=t[1*r+1],y=t[1*r+2],b=t[2*r+0],w=t[2*r+1],E=t[2*r+2];return n?[i*p+s*m,i*d+s*g,u*p+a*m,u*d+a*g]:[i*p+s*m+o*b,i*d+s*g+o*w,i*v+s*y+o*E,u*p+a*m+f*b,u*d+a*g+f*w,u*v+a*y+f*E,l*p+c*m+h*b,l*d+c*g+h*w,l*v+c*y+h*E]}}).call(this);(function(e){"use strict";var t,n=0,r=["ms","moz","webkit","o"];for(t=0;t<r.length&&!e.requestAnimationFrame;t++){e.requestAnimationFrame=e[r[t]+"RequestAnimationFrame"];e.cancelAnimationFrame=e[r[t]+"CancelAnimationFrame"]||e[r[t]+"CancelRequestAnimationFrame"]}if(!e.requestAnimationFrame)e.requestAnimationFrame=function(t,r){var i=(new Date).getTime(),s=Math.max(0,16-(i-n)),o=e.setTimeout(function(){t(i+s)},s);n=i+s;return o};if(!e.cancelAnimationFrame)e.cancelAnimationFrame=function(e){clearTimeout(e)};if(!Function.prototype.bind)Function.prototype.bind=function(e){if(typeof this!=="function")throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),n=this,r,i;r=function(){};i=function(){return n.apply(this instanceof r&&e?this:e,t.concat(Array.prototype.slice.call(arguments)))};r.prototype=this.prototype;i.prototype=new r;return i}})(this);(function(){"use strict";var e=function(){Object.defineProperty(this,"_handlers",{value:{}})};e.prototype.bind=function(e,t){var n,r,i,s;if(arguments.length===1&&typeof arguments[0]==="object")for(e in arguments[0])this.bind(e,arguments[0][e]);else if(arguments.length===2&&typeof arguments[1]==="function"){s=typeof e==="string"?e.split(" "):e;for(n=0,r=s.length;n!==r;n+=1){i=s[n];if(!i)continue;if(!this._handlers[i])this._handlers[i]=[];this._handlers[i].push({handler:t})}}else throw"bind: Wrong arguments.";return this};e.prototype.unbind=function(e,t){var n,r,i,s,o,u,a,f=typeof e==="string"?e.split(" "):e;if(!arguments.length){for(o in this._handlers)delete this._handlers[o];return this}if(t){for(n=0,r=f.length;n!==r;n+=1){a=f[n];if(this._handlers[a]){u=[];for(i=0,s=this._handlers[a].length;i!==s;i+=1)if(this._handlers[a][i].handler!==t)u.push(this._handlers[a][i]);this._handlers[a]=u}if(this._handlers[a]&&this._handlers[a].length===0)delete this._handlers[a]}}else for(n=0,r=f.length;n!==r;n+=1)delete this._handlers[f[n]];return this};e.prototype.dispatchEvent=function(e,t){var n,r,i,s,o,u,a,f=this,l=typeof e==="string"?e.split(" "):e;t=t===undefined?{}:t;for(n=0,r=l.length;n!==r;n+=1){a=l[n];if(this._handlers[a]){u=f.getEvent(a,t);o=[];for(i=0,s=this._handlers[a].length;i!==s;i+=1){this._handlers[a][i].handler(u);if(!this._handlers[a][i].one)o.push(this._handlers[a][i])}this._handlers[a]=o}}return this};e.prototype.getEvent=function(e,t){return{type:e,data:t||{},target:this}};e.extend=function(t,n){var r;for(r in e.prototype)if(e.prototype.hasOwnProperty(r))t[r]=e.prototype[r];e.apply(t,n)};if(typeof this.sigma!=="undefined"){this.sigma.classes=this.sigma.classes||{};this.sigma.classes.dispatcher=e}else if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports)exports=module.exports=e;exports.dispatcher=e}else this.dispatcher=e}).call(this);(function(){"use strict";var e=function(){var t,n,r={},i=Array.prototype.slice.call(arguments,0);var s=function(e,o){var u,a;if(arguments.length===1&&typeof e==="string"){if(e in r&&r[e]!==undefined)return r[e];for(t=0,n=i.length;t<n;t++)if(e in i[t]&&i[t][e]!==undefined)return i[t][e];return undefined}else if(typeof e==="object"&&typeof o==="string"){return o in(e||{})?e[o]:s(o)}else{u=typeof e==="object"&&o===undefined?e:{};if(typeof e==="string")u[e]=o;for(a in u)r[a]=u[a];return this}};s.embedObjects=function(){var t=i.concat(r).concat(Array.prototype.splice.call(arguments,0));return e.apply({},t)};for(t=0,n=arguments.length;t<n;t++)s(arguments[t]);return s};if(typeof this.sigma!=="undefined"){this.sigma.classes=this.sigma.classes||{};this.sigma.classes.configurable=e}else if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports)exports=module.exports=e;exports.configurable=e}else this.configurable=e}).call(this);(function(e){"use strict";function f(e,t,n){var r=function(){var r,o;for(r in s[e])s[e][r].apply(t,arguments);o=n.apply(t,arguments);for(r in i[e])i[e][r].apply(t,arguments);return o};return r}function l(e){var t;for(t in e)if(!("hasOwnProperty"in e)||e.hasOwnProperty(t))delete e[t];return e}var t=Object.create(null),n=Object.create(null),r=Object.create(null),i=Object.create(null),s=Object.create(null),o={immutable:true,clone:true},u=function(e){return o[e]};var a=function(e){var n,i,s;s={settings:e||u,nodesArray:[],edgesArray:[],nodesIndex:Object.create(null),edgesIndex:Object.create(null),inNeighborsIndex:Object.create(null),outNeighborsIndex:Object.create(null),allNeighborsIndex:Object.create(null),inNeighborsCount:Object.create(null),outNeighborsCount:Object.create(null),allNeighborsCount:Object.create(null)};for(n in r)r[n].call(s);for(n in t){i=f(n,s,t[n]);this[n]=i;s[n]=i}};a.addMethod=function(e,n){if(typeof e!=="string"||typeof n!=="function"||arguments.length!==2)throw"addMethod: Wrong arguments.";if(t[e]||a[e])throw'The method "'+e+'" already exists.';t[e]=n;i[e]=Object.create(null);s[e]=Object.create(null);return this};a.hasMethod=function(e){return!!(t[e]||a[e])};a.attach=function(e,t,n,o){if(typeof e!=="string"||typeof t!=="string"||typeof n!=="function"||arguments.length<3||arguments.length>4)throw"attach: Wrong arguments.";var u;if(e==="constructor")u=r;else{if(o){if(!s[e])throw'The method "'+e+'" does not exist.';u=s[e]}else{if(!i[e])throw'The method "'+e+'" does not exist.';u=i[e]}}if(u[t])throw'A function "'+t+'" is already attached '+'to the method "'+e+'".';u[t]=n;return this};a.attachBefore=function(e,t,n){return this.attach(e,t,n,true)};a.addIndex=function(e,t){if(typeof e!=="string"||Object(t)!==t||arguments.length!==2)throw"addIndex: Wrong arguments.";if(n[e])throw'The index "'+e+'" already exists.';var r;n[e]=t;for(r in t)if(typeof t[r]!=="function")throw"The bindings must be functions.";else a.attach(r,e,t[r]);return this};a.addMethod("addNode",function(e){if(Object(e)!==e||arguments.length!==1)throw"addNode: Wrong arguments.";if(typeof e.id!=="string"&&typeof e.id!=="number")throw"The node must have a string or number id.";if(this.nodesIndex[e.id])throw'The node "'+e.id+'" already exists.';var t,n=e.id,r=Object.create(null);if(this.settings("clone")){for(t in e)if(t!=="id")r[t]=e[t]}else r=e;if(this.settings("immutable"))Object.defineProperty(r,"id",{value:n,enumerable:true});else r.id=n;this.inNeighborsIndex[n]=Object.create(null);this.outNeighborsIndex[n]=Object.create(null);this.allNeighborsIndex[n]=Object.create(null);this.inNeighborsCount[n]=0;this.outNeighborsCount[n]=0;this.allNeighborsCount[n]=0;this.nodesArray.push(r);this.nodesIndex[r.id]=r;return this});a.addMethod("addEdge",function(e){if(Object(e)!==e||arguments.length!==1)throw"addEdge: Wrong arguments.";if(typeof e.id!=="string"&&typeof e.id!=="number")throw"The edge must have a string or number id.";if(typeof e.source!=="string"&&typeof e.source!=="number"||!this.nodesIndex[e.source])throw"The edge source must have an existing node id.";if(typeof e.target!=="string"&&typeof e.target!=="number"||!this.nodesIndex[e.target])throw"The edge target must have an existing node id.";if(this.edgesIndex[e.id])throw'The edge "'+e.id+'" already exists.';var t,n=Object.create(null);if(this.settings("clone")){for(t in e)if(t!=="id"&&t!=="source"&&t!=="target")n[t]=e[t]}else n=e;if(this.settings("immutable")){Object.defineProperty(n,"id",{value:e.id,enumerable:true});Object.defineProperty(n,"source",{value:e.source,enumerable:true});Object.defineProperty(n,"target",{value:e.target,enumerable:true})}else{n.id=e.id;n.source=e.source;n.target=e.target}this.edgesArray.push(n);this.edgesIndex[n.id]=n;if(!this.inNeighborsIndex[n.target][n.source])this.inNeighborsIndex[n.target][n.source]=Object.create(null);this.inNeighborsIndex[n.target][n.source][n.id]=n;if(!this.outNeighborsIndex[n.source][n.target])this.outNeighborsIndex[n.source][n.target]=Object.create(null);this.outNeighborsIndex[n.source][n.target][n.id]=n;if(!this.allNeighborsIndex[n.source][n.target])this.allNeighborsIndex[n.source][n.target]=Object.create(null);this.allNeighborsIndex[n.source][n.target][n.id]=n;if(n.target!==n.source){if(!this.allNeighborsIndex[n.target][n.source])this.allNeighborsIndex[n.target][n.source]=Object.create(null);this.allNeighborsIndex[n.target][n.source][n.id]=n}this.inNeighborsCount[n.target]++;this.outNeighborsCount[n.source]++;this.allNeighborsCount[n.target]++;this.allNeighborsCount[n.source]++;return this});a.addMethod("dropNode",function(e){if(typeof e!=="string"&&typeof e!=="number"||arguments.length!==1)throw"dropNode: Wrong arguments.";if(!this.nodesIndex[e])throw'The node "'+e+'" does not exist.';var t,n,r;delete this.nodesIndex[e];for(t=0,r=this.nodesArray.length;t<r;t++)if(this.nodesArray[t].id===e){this.nodesArray.splice(t,1);break}for(t=this.edgesArray.length-1;t>=0;t--)if(this.edgesArray[t].source===e||this.edgesArray[t].target===e)this.dropEdge(this.edgesArray[t].id);delete this.inNeighborsIndex[e];delete this.outNeighborsIndex[e];delete this.allNeighborsIndex[e];delete this.inNeighborsCount[e];delete this.outNeighborsCount[e];delete this.allNeighborsCount[e];for(n in this.nodesIndex){delete this.inNeighborsIndex[n][e];delete this.outNeighborsIndex[n][e];delete this.allNeighborsIndex[n][e]}return this});a.addMethod("dropEdge",function(e){if(typeof e!=="string"&&typeof e!=="number"||arguments.length!==1)throw"dropEdge: Wrong arguments.";if(!this.edgesIndex[e])throw'The edge "'+e+'" does not exist.';var t,n,r;r=this.edgesIndex[e];delete this.edgesIndex[e];for(t=0,n=this.edgesArray.length;t<n;t++)if(this.edgesArray[t].id===e){this.edgesArray.splice(t,1);break}delete this.inNeighborsIndex[r.target][r.source][r.id];if(!Object.keys(this.inNeighborsIndex[r.target][r.source]).length)delete this.inNeighborsIndex[r.target][r.source];delete this.outNeighborsIndex[r.source][r.target][r.id];if(!Object.keys(this.outNeighborsIndex[r.source][r.target]).length)delete this.outNeighborsIndex[r.source][r.target];delete this.allNeighborsIndex[r.source][r.target][r.id];if(!Object.keys(this.allNeighborsIndex[r.source][r.target]).length)delete this.allNeighborsIndex[r.source][r.target];if(r.target!==r.source){delete this.allNeighborsIndex[r.target][r.source][r.id];if(!Object.keys(this.allNeighborsIndex[r.target][r.source]).length)delete this.allNeighborsIndex[r.target][r.source]}this.inNeighborsCount[r.target]--;this.outNeighborsCount[r.source]--;this.allNeighborsCount[r.source]--;this.allNeighborsCount[r.target]--;return this});a.addMethod("kill",function(){this.nodesArray.length=0;this.edgesArray.length=0;delete this.nodesArray;delete this.edgesArray;delete this.nodesIndex;delete this.edgesIndex;delete this.inNeighborsIndex;delete this.outNeighborsIndex;delete this.allNeighborsIndex;delete this.inNeighborsCount;delete this.outNeighborsCount;delete this.allNeighborsCount});a.addMethod("clear",function(){this.nodesArray.length=0;this.edgesArray.length=0;l(this.nodesIndex);l(this.edgesIndex);l(this.nodesIndex);l(this.inNeighborsIndex);l(this.outNeighborsIndex);l(this.allNeighborsIndex);l(this.inNeighborsCount);l(this.outNeighborsCount);l(this.allNeighborsCount);return this});a.addMethod("read",function(e){var t,n,r;n=e.nodes||[];for(t=0,r=n.length;t<r;t++)this.addNode(n[t]);n=e.edges||[];for(t=0,r=n.length;t<r;t++)this.addEdge(n[t]);return this});a.addMethod("nodes",function(e){if(!arguments.length)return this.nodesArray.slice(0);if(arguments.length===1&&(typeof e==="string"||typeof e==="number"))return this.nodesIndex[e];if(arguments.length===1&&Object.prototype.toString.call(e)==="[object Array]"){var t,n,r=[];for(t=0,n=e.length;t<n;t++)if(typeof e[t]==="string"||typeof e[t]==="number")r.push(this.nodesIndex[e[t]]);else throw"nodes: Wrong arguments.";return r}throw"nodes: Wrong arguments."});a.addMethod("degree",function(e,t){t={"in":this.inNeighborsCount,out:this.outNeighborsCount}[t||""]||this.allNeighborsCount;if(typeof e==="string"||typeof e==="number")return t[e];if(Object.prototype.toString.call(e)==="[object Array]"){var n,r,i=[];for(n=0,r=e.length;n<r;n++)if(typeof e[n]==="string"||typeof e[n]==="number")i.push(t[e[n]]);else throw"degree: Wrong arguments.";return i}throw"degree: Wrong arguments."});a.addMethod("edges",function(e){if(!arguments.length)return this.edgesArray.slice(0);if(arguments.length===1&&(typeof e==="string"||typeof e==="number"))return this.edgesIndex[e];if(arguments.length===1&&Object.prototype.toString.call(e)==="[object Array]"){var t,n,r=[];for(t=0,n=e.length;t<n;t++)if(typeof e[t]==="string"||typeof e[t]==="number")r.push(this.edgesIndex[e[t]]);else throw"edges: Wrong arguments.";return r}throw"edges: Wrong arguments."});if(typeof sigma!=="undefined"){sigma.classes=sigma.classes||Object.create(null);sigma.classes.graph=a}else if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports)exports=module.exports=a;exports.graph=a}else this.graph=a}).call(this);(function(e){"use strict";if(typeof sigma==="undefined")throw"sigma is not declared";sigma.utils.pkg("sigma.classes");sigma.classes.camera=function(e,t,n,r){sigma.classes.dispatcher.extend(this);Object.defineProperty(this,"graph",{value:t});Object.defineProperty(this,"id",{value:e});Object.defineProperty(this,"readPrefix",{value:"read_cam"+e+":"});Object.defineProperty(this,"prefix",{value:"cam"+e+":"});this.x=0;this.y=0;this.ratio=1;this.angle=0;this.isAnimated=false;this.settings=typeof r==="object"&&r?n.embedObject(r):n};sigma.classes.camera.prototype.goTo=function(t){if(!this.settings("enableCamera"))return this;var n,r,i=t||{},s=["x","y","ratio","angle"];for(n=0,r=s.length;n<r;n++)if(i[s[n]]!==e){if(typeof i[s[n]]==="number"&&!isNaN(i[s[n]]))this[s[n]]=i[s[n]];else throw'Value for "'+s[n]+'" is not a number.'}this.dispatchEvent("coordinatesUpdated");return this};sigma.classes.camera.prototype.applyView=function(t,n,r){r=r||{};n=n!==e?n:this.prefix;t=t!==e?t:this.readPrefix;var i=r.nodes||this.graph.nodes(),s=r.edges||this.graph.edges();var o,u,a,f=Math.cos(this.angle),l=Math.sin(this.angle);for(o=0,u=i.length;o<u;o++){a=i[o];a[n+"x"]=(((a[t+"x"]||0)-this.x)*f+((a[t+"y"]||0)-this.y)*l)/this.ratio+(r.width||0)/2;a[n+"y"]=(((a[t+"y"]||0)-this.y)*f-((a[t+"x"]||0)-this.x)*l)/this.ratio+(r.height||0)/2;a[n+"size"]=(a[t+"size"]||0)/Math.pow(this.ratio,this.settings("nodesPowRatio"))}for(o=0,u=s.length;o<u;o++){s[o][n+"size"]=(s[o][t+"size"]||0)/Math.pow(this.ratio,this.settings("edgesPowRatio"))}return this};sigma.classes.camera.prototype.graphPosition=function(e,t,n){var r=0,i=0,s=Math.cos(this.angle),o=Math.sin(this.angle);if(!n){r=-(this.x*s+this.y*o)/this.ratio;i=-(this.y*s-this.x*o)/this.ratio}return{x:(e*s+t*o)/this.ratio+r,y:(t*s-e*o)/this.ratio+i}};sigma.classes.camera.prototype.cameraPosition=function(e,t,n){var r=0,i=0,s=Math.cos(this.angle),o=Math.sin(this.angle);if(!n){r=-(this.x*s+this.y*o)/this.ratio;i=-(this.y*s-this.x*o)/this.ratio}return{x:((e-r)*s-(t-i)*o)*this.ratio,y:((t-i)*s+(e-r)*o)*this.ratio}};sigma.classes.camera.prototype.getMatrix=function(){var e=sigma.utils.matrices.scale(1/this.ratio),t=sigma.utils.matrices.rotation(this.angle),n=sigma.utils.matrices.translation(-this.x,-this.y),r=sigma.utils.matrices.multiply(n,sigma.utils.matrices.multiply(t,e));return r};sigma.classes.camera.prototype.getRectangle=function(e,t){var n=this.cameraPosition(e,0,true),r=this.cameraPosition(0,t,true),i=this.cameraPosition(e/2,t/2,true),s=this.cameraPosition(e/4,0,true).x,o=this.cameraPosition(0,t/4,true).y;return{x1:this.x-i.x-s,y1:this.y-i.y-o,x2:this.x-i.x+s+n.x,y2:this.y-i.y-o+n.y,height:Math.sqrt(Math.pow(r.x,2)+Math.pow(r.y+2*o,2))}}}).call(this);(function(e){"use strict";function n(e,t){var n=t.x+t.width/2,r=t.y+t.height/2,i=e.y<r,s=e.x<n;if(i){if(s)return 0;else return 1}else{if(s)return 2;else return 3}}function r(e,t){var n=[];for(var r=0;r<4;r++)if(e.x2>=t[r][0].x&&e.x1<=t[r][1].x&&e.y1+e.height>=t[r][0].y&&e.y1<=t[r][2].y)n.push(r);return n}function i(e,n){var r=[];for(var i=0;i<4;i++)if(t.collision(e,n[i]))r.push(i);return r}function s(e,t){var n=t.level+1,r=Math.round(t.bounds.width/2),i=Math.round(t.bounds.height/2),s=Math.round(t.bounds.x),o=Math.round(t.bounds.y),u,a;switch(e){case 0:u=s;a=o;break;case 1:u=s+r;a=o;break;case 2:u=s;a=o+i;break;case 3:u=s+r;a=o+i;break}return f({x:u,y:a,width:r,height:i},n,t.maxElements,t.maxLevel)}function o(t,n,i){if(i.level<i.maxLevel){var u=r(n,i.corners);for(var a=0,f=u.length;a<f;a++){if(i.nodes[u[a]]===e)i.nodes[u[a]]=s(u[a],i);o(t,n,i.nodes[u[a]])}}else{i.elements.push(t)}}function u(t,r){if(r.level<r.maxLevel){var i=n(t,r.bounds);if(r.nodes[i]!==e){return u(t,r.nodes[i])}else{return[]}}else{return r.elements}}function a(t,n,r,i){i=i||{};if(n.level<n.maxLevel){var s=r(t,n.corners);for(var o=0,u=s.length;o<u;o++)if(n.nodes[s[o]]!==e)a(t,n.nodes[s[o]],r,i)}else for(var f=0,l=n.elements.length;f<l;f++)if(i[n.elements[f].id]===e)i[n.elements[f].id]=n.elements[f];return i}function f(e,n,r,i){return{level:n||0,bounds:e,corners:t.splitSquare(e),maxElements:r||20,maxLevel:i||4,elements:[],nodes:[]}}var t={pointToSquare:function(e){return{x1:e.x-e.size,y1:e.y-e.size,x2:e.x+e.size,y2:e.y-e.size,height:e.size*2}},isAxisAligned:function(e){return e.x1===e.x2||e.y1===e.y2},axisAlignedTopPoints:function(e){if(e.y1===e.y2&&e.x1<e.x2)return e;if(e.x1===e.x2&&e.y2>e.y1)return{x1:e.x1-e.height,y1:e.y1,x2:e.x1,y2:e.y1,height:e.height};if(e.x1===e.x2&&e.y2<e.y1)return{x1:e.x1,y1:e.y2,x2:e.x2+e.height,y2:e.y2,height:e.height};return{x1:e.x2,y1:e.y1-e.height,x2:e.x1,y2:e.y1-e.height,height:e.height}},lowerLeftCoor:function(e){var t=Math.sqrt(Math.pow(e.x2-e.x1,2)+Math.pow(e.y2-e.y1,2));return{x:e.x1-(e.y2-e.y1)*e.height/t,y:e.y1+(e.x2-e.x1)*e.height/t}},lowerRightCoor:function(e,t){return{x:t.x-e.x1+e.x2,y:t.y-e.y1+e.y2}},rectangleCorners:function(e){var t=this.lowerLeftCoor(e),n=this.lowerRightCoor(e,t);return[{x:e.x1,y:e.y1},{x:e.x2,y:e.y2},{x:t.x,y:t.y},{x:n.x,y:n.y}]},splitSquare:function(e){return[[{x:e.x,y:e.y},{x:e.x+e.width/2,y:e.y},{x:e.x,y:e.y+e.height/2},{x:e.x+e.width/2,y:e.y+e.height/2}],[{x:e.x+e.width/2,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width/2,y:e.y+e.height/2},{x:e.x+e.width,y:e.y+e.height/2}],[{x:e.x,y:e.y+e.height/2},{x:e.x+e.width/2,y:e.y+e.height/2},{x:e.x,y:e.y+e.height},{x:e.x+e.width/2,y:e.y+e.height}],[{x:e.x+e.width/2,y:e.y+e.height/2},{x:e.x+e.width,y:e.y+e.height/2},{x:e.x+e.width/2,y:e.y+e.height},{x:e.x+e.width,y:e.y+e.height}]]},axis:function(e,t){return[{x:e[1].x-e[0].x,y:e[1].y-e[0].y},{x:e[1].x-e[3].x,y:e[1].y-e[3].y},{x:t[0].x-t[2].x,y:t[0].y-t[2].y},{x:t[0].x-t[1].x,y:t[0].y-t[1].y}]},projection:function(e,t){var n=(e.x*t.x+e.y*t.y)/(Math.pow(t.x,2)+Math.pow(t.y,2));return{x:n*t.x,y:n*t.y}},axisCollision:function(e,t,n){var r=[],i=[];for(var s=0;s<4;s++){var o=this.projection(t[s],e),u=this.projection(n[s],e);r.push(o.x*e.x+o.y*e.y);i.push(u.x*e.x+u.y*e.y)}var a=Math.max.apply(Math,r),f=Math.max.apply(Math,i),l=Math.min.apply(Math,r),c=Math.min.apply(Math,i);return c<=a&&f>=l},collision:function(e,t){var n=this.axis(e,t),r=true;for(var i=0;i<4;i++){r*=this.axisCollision(n[i],e,t)}return!!r}};var l=function(){this._geom=t;this._tree=null;this._cache={query:false,result:false}};l.prototype.index=function(e,n){if(!n.bounds)throw"sigma.classes.quad.index: bounds information not given.";var r=n.prefix||"";this._tree=f(n.bounds,0,n.maxElements,n.maxLevel);for(var i=0,s=e.length;i<s;i++){o(e[i],t.pointToSquare({x:e[i][r+"x"],y:e[i][r+"y"],size:e[i][r+"size"]}),this._tree)}this._cache={query:false,result:false};return this._tree};l.prototype.point=function(e,t){return this._tree?u({x:e,y:t},this._tree)||[]:[]};l.prototype.area=function(e){var n=JSON.stringify(e),s,o;if(this._cache.query===n)return this._cache.result;if(t.isAxisAligned(e)){s=r;o=t.axisAlignedTopPoints(e)}else{s=i;o=t.rectangleCorners(e)}var u=this._tree?a(o,this._tree,s):[];var f=[];for(var l in u)f.push(u[l]);this._cache.query=n;this._cache.result=f;return f};if(typeof this.sigma!=="undefined"){this.sigma.classes=this.sigma.classes||{};this.sigma.classes.quad=l}else if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports)exports=module.exports=l;exports.quad=l}else this.quad=l}).call(this);(function(e){"use strict";function n(e,t){var n=t.x+t.width/2,r=t.y+t.height/2,i=e.y<r,s=e.x<n;if(i){if(s)return 0;else return 1}else{if(s)return 2;else return 3}}function r(e,t){var n=[];for(var r=0;r<4;r++)if(e.x2>=t[r][0].x&&e.x1<=t[r][1].x&&e.y1+e.height>=t[r][0].y&&e.y1<=t[r][2].y)n.push(r);return n}function i(e,n){var r=[];for(var i=0;i<4;i++)if(t.collision(e,n[i]))r.push(i);return r}function s(e,t){var n=t.level+1,r=Math.round(t.bounds.width/2),i=Math.round(t.bounds.height/2),s=Math.round(t.bounds.x),o=Math.round(t.bounds.y),u,a;switch(e){case 0:u=s;a=o;break;case 1:u=s+r;a=o;break;case 2:u=s;a=o+i;break;case 3:u=s+r;a=o+i;break}return f({x:u,y:a,width:r,height:i},n,t.maxElements,t.maxLevel)}function o(t,n,i){if(i.level<i.maxLevel){var u=r(n,i.corners);for(var a=0,f=u.length;a<f;a++){if(i.nodes[u[a]]===e)i.nodes[u[a]]=s(u[a],i);o(t,n,i.nodes[u[a]])}}else{i.elements.push(t)}}function u(t,r){if(r.level<r.maxLevel){var i=n(t,r.bounds);if(r.nodes[i]!==e){return u(t,r.nodes[i])}else{return[]}}else{return r.elements}}function a(t,n,r,i){i=i||{};if(n.level<n.maxLevel){var s=r(t,n.corners);for(var o=0,u=s.length;o<u;o++)if(n.nodes[s[o]]!==e)a(t,n.nodes[s[o]],r,i)}else for(var f=0,l=n.elements.length;f<l;f++)if(i[n.elements[f].id]===e)i[n.elements[f].id]=n.elements[f];return i}function f(e,n,r,i){return{level:n||0,bounds:e,corners:t.splitSquare(e),maxElements:r||40,maxLevel:i||8,elements:[],nodes:[]}}var t={pointToSquare:function(e){return{x1:e.x-e.size,y1:e.y-e.size,x2:e.x+e.size,y2:e.y-e.size,height:e.size*2}},lineToSquare:function(e){if(e.y1<e.y2){if(e.x1<e.x2){return{x1:e.x1-e.size,y1:e.y1-e.size,x2:e.x2+e.size,y2:e.y1-e.size,height:e.y2-e.y1+e.size*2}}return{x1:e.x2-e.size,y1:e.y1-e.size,x2:e.x1+e.size,y2:e.y1-e.size,height:e.y2-e.y1+e.size*2}}if(e.x1<e.x2){return{x1:e.x1-e.size,y1:e.y2-e.size,x2:e.x2+e.size,y2:e.y2-e.size,height:e.y1-e.y2+e.size*2}}return{x1:e.x2-e.size,y1:e.y2-e.size,x2:e.x1+e.size,y2:e.y2-e.size,height:e.y1-e.y2+e.size*2}},quadraticCurveToSquare:function(e,t){var n=sigma.utils.getPointOnQuadraticCurve(.5,e.x1,e.y1,e.x2,e.y2,t.x,t.y);var r=Math.min(e.x1,e.x2,n.x),i=Math.max(e.x1,e.x2,n.x),s=Math.min(e.y1,e.y2,n.y),o=Math.max(e.y1,e.y2,n.y);return{x1:r-e.size,y1:s-e.size,x2:i+e.size,y2:s-e.size,height:o-s+e.size*2}},selfLoopToSquare:function(e){var t=sigma.utils.getSelfLoopControlPoints(e.x,e.y,e.size);var n=Math.min(e.x,t.x1,t.x2),r=Math.max(e.x,t.x1,t.x2),i=Math.min(e.y,t.y1,t.y2),s=Math.max(e.y,t.y1,t.y2);return{x1:n-e.size,y1:i-e.size,x2:r+e.size,y2:i-e.size,height:s-i+e.size*2}},isAxisAligned:function(e){return e.x1===e.x2||e.y1===e.y2},axisAlignedTopPoints:function(e){if(e.y1===e.y2&&e.x1<e.x2)return e;if(e.x1===e.x2&&e.y2>e.y1)return{x1:e.x1-e.height,y1:e.y1,x2:e.x1,y2:e.y1,height:e.height};if(e.x1===e.x2&&e.y2<e.y1)return{x1:e.x1,y1:e.y2,x2:e.x2+e.height,y2:e.y2,height:e.height};return{x1:e.x2,y1:e.y1-e.height,x2:e.x1,y2:e.y1-e.height,height:e.height}},lowerLeftCoor:function(e){var t=Math.sqrt(Math.pow(e.x2-e.x1,2)+Math.pow(e.y2-e.y1,2));return{x:e.x1-(e.y2-e.y1)*e.height/t,y:e.y1+(e.x2-e.x1)*e.height/t}},lowerRightCoor:function(e,t){return{x:t.x-e.x1+e.x2,y:t.y-e.y1+e.y2}},rectangleCorners:function(e){var t=this.lowerLeftCoor(e),n=this.lowerRightCoor(e,t);return[{x:e.x1,y:e.y1},{x:e.x2,y:e.y2},{x:t.x,y:t.y},{x:n.x,y:n.y}]},splitSquare:function(e){return[[{x:e.x,y:e.y},{x:e.x+e.width/2,y:e.y},{x:e.x,y:e.y+e.height/2},{x:e.x+e.width/2,y:e.y+e.height/2}],[{x:e.x+e.width/2,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width/2,y:e.y+e.height/2},{x:e.x+e.width,y:e.y+e.height/2}],[{x:e.x,y:e.y+e.height/2},{x:e.x+e.width/2,y:e.y+e.height/2},{x:e.x,y:e.y+e.height},{x:e.x+e.width/2,y:e.y+e.height}],[{x:e.x+e.width/2,y:e.y+e.height/2},{x:e.x+e.width,y:e.y+e.height/2},{x:e.x+e.width/2,y:e.y+e.height},{x:e.x+e.width,y:e.y+e.height}]]},axis:function(e,t){return[{x:e[1].x-e[0].x,y:e[1].y-e[0].y},{x:e[1].x-e[3].x,y:e[1].y-e[3].y},{x:t[0].x-t[2].x,y:t[0].y-t[2].y},{x:t[0].x-t[1].x,y:t[0].y-t[1].y}]},projection:function(e,t){var n=(e.x*t.x+e.y*t.y)/(Math.pow(t.x,2)+Math.pow(t.y,2));return{x:n*t.x,y:n*t.y}},axisCollision:function(e,t,n){var r=[],i=[];for(var s=0;s<4;s++){var o=this.projection(t[s],e),u=this.projection(n[s],e);r.push(o.x*e.x+o.y*e.y);i.push(u.x*e.x+u.y*e.y)}var a=Math.max.apply(Math,r),f=Math.max.apply(Math,i),l=Math.min.apply(Math,r),c=Math.min.apply(Math,i);return c<=a&&f>=l},collision:function(e,t){var n=this.axis(e,t),r=true;for(var i=0;i<4;i++){r*=this.axisCollision(n[i],e,t)}return!!r}};var l=function(){this._geom=t;this._tree=null;this._cache={query:false,result:false};this._enabled=true};l.prototype.index=function(e,n){if(!this._enabled)return this._tree;if(!n.bounds)throw"sigma.classes.edgequad.index: bounds information not given.";var r=n.prefix||"",i,s,u,a,l;this._tree=f(n.bounds,0,n.maxElements,n.maxLevel);var c=e.edges();for(var h=0,p=c.length;h<p;h++){s=e.nodes(c[h].source);u=e.nodes(c[h].target);l={x1:s[r+"x"],y1:s[r+"y"],x2:u[r+"x"],y2:u[r+"y"],size:c[h][r+"size"]||0};if(c[h].type==="curve"||c[h].type==="curvedArrow"){if(s.id===u.id){a={x:s[r+"x"],y:s[r+"y"],size:s[r+"size"]||0};o(c[h],t.selfLoopToSquare(a),this._tree)}else{i=sigma.utils.getQuadraticControlPoint(l.x1,l.y1,l.x2,l.y2);o(c[h],t.quadraticCurveToSquare(l,i),this._tree)}}else{o(c[h],t.lineToSquare(l),this._tree)}}this._cache={query:false,result:false};return this._tree};l.prototype.point=function(e,t){if(!this._enabled)return[];return this._tree?u({x:e,y:t},this._tree)||[]:[]};l.prototype.area=function(e){if(!this._enabled)return[];var n=JSON.stringify(e),s,o;if(this._cache.query===n)return this._cache.result;if(t.isAxisAligned(e)){s=r;o=t.axisAlignedTopPoints(e)}else{s=i;o=t.rectangleCorners(e)}var u=this._tree?a(o,this._tree,s):[];var f=[];for(var l in u)f.push(u[l]);this._cache.query=n;this._cache.result=f;return f};if(typeof this.sigma!=="undefined"){this.sigma.classes=this.sigma.classes||{};this.sigma.classes.edgequad=l}else if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports)exports=module.exports=l;exports.edgequad=l}else this.edgequad=l}).call(this);(function(e){"use strict";if(typeof sigma==="undefined")throw"sigma is not declared";sigma.utils.pkg("sigma.captors");sigma.captors.mouse=function(e,t,n){function E(e){var t,n,i;if(o("mouseEnabled"))r.dispatchEvent("mousemove",{x:sigma.utils.getX(e)-sigma.utils.getWidth(e)/2,y:sigma.utils.getY(e)-sigma.utils.getHeight(e)/2,clientX:e.clientX,clientY:e.clientY,ctrlKey:e.ctrlKey,metaKey:e.metaKey,altKey:e.altKey,shiftKey:e.shiftKey});if(o("mouseEnabled")&&m){g=true;y=true;if(w)clearTimeout(w);w=setTimeout(function(){g=false},o("dragTimeout"));sigma.misc.animation.killAll(s);s.isMoving=true;i=s.cameraPosition(sigma.utils.getX(e)-d,sigma.utils.getY(e)-v,true);t=u-i.x;n=a-i.y;if(t!==s.x||n!==s.y){l=s.x;c=s.y;s.goTo({x:t,y:n})}if(e.preventDefault)e.preventDefault();else e.returnValue=false;e.stopPropagation();return false}}function S(e){if(o("mouseEnabled")&&m){m=false;if(w)clearTimeout(w);s.isMoving=false;var t=sigma.utils.getX(e),n=sigma.utils.getY(e);if(g){sigma.misc.animation.killAll(s);sigma.misc.animation.camera(s,{x:s.x+o("mouseInertiaRatio")*(s.x-l),y:s.y+o("mouseInertiaRatio")*(s.y-c)},{easing:"quadraticOut",duration:o("mouseInertiaDuration")})}else if(d!==t||v!==n)s.goTo({x:s.x,y:s.y});r.dispatchEvent("mouseup",{x:t-sigma.utils.getWidth(e)/2,y:n-sigma.utils.getHeight(e)/2,clientX:e.clientX,clientY:e.clientY,ctrlKey:e.ctrlKey,metaKey:e.metaKey,altKey:e.altKey,shiftKey:e.shiftKey});g=false}}function x(e){if(o("mouseEnabled")){u=s.x;a=s.y;l=s.x;c=s.y;d=sigma.utils.getX(e);v=sigma.utils.getY(e);y=false;b=(new Date).getTime();switch(e.which){case 2:break;case 3:r.dispatchEvent("rightclick",{x:d-sigma.utils.getWidth(e)/2,y:v-sigma.utils.getHeight(e)/2,clientX:e.clientX,clientY:e.clientY,ctrlKey:e.ctrlKey,metaKey:e.metaKey,altKey:e.altKey,shiftKey:e.shiftKey});break;default:m=true;r.dispatchEvent("mousedown",{x:d-sigma.utils.getWidth(e)/2,y:v-sigma.utils.getHeight(e)/2,clientX:e.clientX,clientY:e.clientY,ctrlKey:e.ctrlKey,metaKey:e.metaKey,altKey:e.altKey,shiftKey:e.shiftKey})}}}function T(e){if(o("mouseEnabled"))r.dispatchEvent("mouseout")}function N(e){if(o("mouseEnabled"))r.dispatchEvent("click",{x:sigma.utils.getX(e)-sigma.utils.getWidth(e)/2,y:sigma.utils.getY(e)-sigma.utils.getHeight(e)/2,clientX:e.clientX,clientY:e.clientY,ctrlKey:e.ctrlKey,metaKey:e.metaKey,altKey:e.altKey,shiftKey:e.shiftKey,isDragging:(new Date).getTime()-b>100&&y});if(e.preventDefault)e.preventDefault();else e.returnValue=false;e.stopPropagation();return false}function C(e){var t,n,i;if(o("mouseEnabled")){n=1/o("doubleClickZoomingRatio");r.dispatchEvent("doubleclick",{x:d-sigma.utils.getWidth(e)/2,y:v-sigma.utils.getHeight(e)/2,clientX:e.clientX,clientY:e.clientY,ctrlKey:e.ctrlKey,metaKey:e.metaKey,altKey:e.altKey,shiftKey:e.shiftKey});if(o("doubleClickEnabled")){t=s.cameraPosition(sigma.utils.getX(e)-sigma.utils.getWidth(e)/2,sigma.utils.getY(e)-sigma.utils.getHeight(e)/2,true);i={duration:o("doubleClickZoomDuration")};sigma.utils.zoomTo(s,t.x,t.y,n,i)}if(e.preventDefault)e.preventDefault();else e.returnValue=false;e.stopPropagation();return false}}function k(e){var t,n,r;if(o("mouseEnabled")&&o("mouseWheelEnabled")){n=sigma.utils.getDelta(e)>0?1/o("zoomingRatio"):o("zoomingRatio");t=s.cameraPosition(sigma.utils.getX(e)-sigma.utils.getWidth(e)/2,sigma.utils.getY(e)-sigma.utils.getHeight(e)/2,true);r={duration:o("mouseZoomDuration")};sigma.utils.zoomTo(s,t.x,t.y,n,r);if(e.preventDefault)e.preventDefault();else e.returnValue=false;e.stopPropagation();return false}}var r=this,i=e,s=t,o=n,u,a,f,l,c,h,p,d,v,m,g,y,b,w;sigma.classes.dispatcher.extend(this);sigma.utils.doubleClick(i,"click",C);i.addEventListener("DOMMouseScroll",k,false);i.addEventListener("mousewheel",k,false);i.addEventListener("mousemove",E,false);i.addEventListener("mousedown",x,false);i.addEventListener("click",N,false);i.addEventListener("mouseout",T,false);document.addEventListener("mouseup",S,false);this.kill=function(){sigma.utils.unbindDoubleClick(i,"click");i.removeEventListener("DOMMouseScroll",k);i.removeEventListener("mousewheel",k);i.removeEventListener("mousemove",E);i.removeEventListener("mousedown",x);i.removeEventListener("click",N);i.removeEventListener("mouseout",T);document.removeEventListener("mouseup",S)}}}).call(this);(function(e){"use strict";if(typeof sigma==="undefined")throw"sigma is not declared";sigma.utils.pkg("sigma.captors");sigma.captors.touch=function(e,t,n){function C(e){var t=sigma.utils.getOffset(i);return{x:e.pageX-t.left,y:e.pageY-t.top}}function k(e){if(o("touchEnabled")){var t,n,r,i,p,d;v=e.touches;switch(v.length){case 1:s.isMoving=true;S=1;u=s.x;a=s.y;c=s.x;h=s.y;p=C(v[0]);m=p.x;g=p.y;break;case 2:s.isMoving=true;S=2;p=C(v[0]);d=C(v[1]);t=p.x;r=p.y;n=d.x;i=d.y;c=s.x;h=s.y;f=s.angle;l=s.ratio;u=s.x;a=s.y;m=t;g=r;y=n;b=i;w=Math.atan2(b-g,y-m);E=Math.sqrt(Math.pow(b-g,2)+Math.pow(y-m,2));e.preventDefault();return false}}}function L(e){if(o("touchEnabled")){v=e.touches;var t=o("touchInertiaRatio");if(N){x=false;clearTimeout(N)}switch(S){case 2:if(e.touches.length===1){k(e);e.preventDefault();break};case 1:s.isMoving=false;r.dispatchEvent("stopDrag");if(x){T=false;sigma.misc.animation.camera(s,{x:s.x+t*(s.x-c),y:s.y+t*(s.y-h)},{easing:"quadraticOut",duration:o("touchInertiaDuration")})}x=false;S=0;break}}}function A(e){if(!T&&o("touchEnabled")){var t,n,i,k,L,A,O,M,_,D,P,H,B,j,F,I,q;v=e.touches;x=true;if(N)clearTimeout(N);N=setTimeout(function(){x=false},o("dragTimeout"));switch(S){case 1:M=C(v[0]);t=M.x;i=M.y;D=s.cameraPosition(t-m,i-g,true);j=u-D.x;F=a-D.y;if(j!==s.x||F!==s.y){c=s.x;h=s.y;s.goTo({x:j,y:F});r.dispatchEvent("mousemove",{x:M.x-sigma.utils.getWidth(e)/2,y:M.y-sigma.utils.getHeight(e)/2,clientX:e.clientX,clientY:e.clientY,ctrlKey:e.ctrlKey,metaKey:e.metaKey,altKey:e.altKey,shiftKey:e.shiftKey});r.dispatchEvent("drag")}break;case 2:M=C(v[0]);_=C(v[1]);t=M.x;i=M.y;n=_.x;k=_.y;P=s.cameraPosition((m+y)/2-sigma.utils.getWidth(e)/2,(g+b)/2-sigma.utils.getHeight(e)/2,true);O=s.cameraPosition((t+n)/2-sigma.utils.getWidth(e)/2,(i+k)/2-sigma.utils.getHeight(e)/2,true);H=Math.atan2(k-i,n-t)-w;B=Math.sqrt(Math.pow(k-i,2)+Math.pow(n-t,2))/E;t=P.x;i=P.y;I=l/B;t=t*B;i=i*B;q=f-H;L=Math.cos(-H);A=Math.sin(-H);n=t*L+i*A;k=i*L-t*A;t=n;i=k;j=t-O.x+u;F=i-O.y+a;if(I!==s.ratio||q!==s.angle||j!==s.x||F!==s.y){c=s.x;h=s.y;p=s.angle;d=s.ratio;s.goTo({x:j,y:F,angle:q,ratio:I});r.dispatchEvent("drag")}break}e.preventDefault();return false}}function O(e){var t,n,i;if(e.touches&&e.touches.length===1&&o("touchEnabled")){T=true;n=1/o("doubleClickZoomingRatio");t=C(e.touches[0]);r.dispatchEvent("doubleclick",{x:t.x-sigma.utils.getWidth(e)/2,y:t.y-sigma.utils.getHeight(e)/2,clientX:e.clientX,clientY:e.clientY,ctrlKey:e.ctrlKey,metaKey:e.metaKey,altKey:e.altKey,shiftKey:e.shiftKey});if(o("doubleClickEnabled")){t=s.cameraPosition(t.x-sigma.utils.getWidth(e)/2,t.y-sigma.utils.getHeight(e)/2,true);i={duration:o("doubleClickZoomDuration"),onComplete:function(){T=false}};sigma.utils.zoomTo(s,t.x,t.y,n,i)}if(e.preventDefault)e.preventDefault();else e.returnValue=false;e.stopPropagation();return false}}var r=this,i=e,s=t,o=n,u,a,f,l,c,h,p,d,v=[],m,g,y,b,w,E,S,x,T,N;sigma.classes.dispatcher.extend(this);sigma.utils.doubleClick(i,"touchstart",O);i.addEventListener("touchstart",k,false);i.addEventListener("touchend",L,false);i.addEventListener("touchcancel",L,false);i.addEventListener("touchleave",L,false);i.addEventListener("touchmove",A,false);this.kill=function(){sigma.utils.unbindDoubleClick(i,"touchstart");i.addEventListener("touchstart",k);i.addEventListener("touchend",L);i.addEventListener("touchcancel",L);i.addEventListener("touchleave",L);i.addEventListener("touchmove",A)}}}).call(this);(function(e){"use strict";if(typeof sigma==="undefined")throw"sigma is not declared";if(typeof conrad==="undefined")throw"conrad is not declared";sigma.utils.pkg("sigma.renderers");sigma.renderers.canvas=function(e,t,n,r){if(typeof r!=="object")throw"sigma.renderers.canvas: Wrong arguments.";if(!(r.container instanceof HTMLElement))throw"Container not found.";var i,s,o,u,a,f=this;sigma.classes.dispatcher.extend(this);Object.defineProperty(this,"conradId",{value:sigma.utils.id()});this.graph=e;this.camera=t;this.contexts={};this.domElements={};this.options=r;this.container=this.options.container;this.settings=typeof r.settings==="object"&&r.settings?n.embedObjects(r.settings):n;this.nodesOnScreen=[];this.edgesOnScreen=[];this.jobs={};this.options.prefix="renderer"+this.conradId+":";if(!this.settings("batchEdgesDrawing")){this.initDOM("canvas","scene");this.contexts.edges=this.contexts.scene;this.contexts.nodes=this.contexts.scene;this.contexts.labels=this.contexts.scene}else{this.initDOM("canvas","edges");this.initDOM("canvas","scene");this.contexts.nodes=this.contexts.scene;this.contexts.labels=this.contexts.scene}this.initDOM("canvas","mouse");this.contexts.hover=this.contexts.mouse;this.captors=[];u=this.options.captors||[sigma.captors.mouse,sigma.captors.touch];for(s=0,o=u.length;s<o;s++){a=typeof u[s]==="function"?u[s]:sigma.captors[u[s]];this.captors.push(new a(this.domElements.mouse,this.camera,this.settings))}sigma.misc.bindEvents.call(this,this.options.prefix);this.resize(false)};sigma.renderers.canvas.prototype.render=function(t){t=t||{};var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m={},g=this.graph,y=this.graph.nodes,b=this.options.prefix||"",w=this.settings(t,"drawEdges"),E=this.settings(t,"drawNodes"),S=this.settings(t,"drawLabels"),x=this.settings(t,"drawEdgeLabels"),T=this.settings.embedObjects(t,{prefix:this.options.prefix});this.resize(false);if(this.settings(t,"hideEdgesOnMove"))if(this.camera.isAnimated||this.camera.isMoving)w=false;this.camera.applyView(e,this.options.prefix,{width:this.width,height:this.height});this.clear();for(i in this.jobs)if(conrad.hasJob(i))conrad.killJob(i);this.edgesOnScreen=[];this.nodesOnScreen=this.camera.quadtree.area(this.camera.getRectangle(this.width,this.height));for(n=this.nodesOnScreen,r=0,s=n.length;r<s;r++)m[n[r].id]=n[r];if(w){for(n=g.edges(),r=0,s=n.length;r<s;r++){o=n[r];if((m[o.source]||m[o.target])&&!o.hidden&&!y(o.source).hidden&&!y(o.target).hidden)this.edgesOnScreen.push(o)}if(this.settings(t,"batchEdgesDrawing")){u="edges_"+this.conradId;d=T("canvasEdgesBatchSize");c=this.edgesOnScreen;s=c.length;l=0;a=Math.min(c.length,l+d);f=function(){v=this.contexts.edges.globalCompositeOperation;this.contexts.edges.globalCompositeOperation="destination-over";h=sigma.canvas.edges;for(r=l;r<a;r++){o=c[r];(h[o.type||this.settings(t,"defaultEdgeType")]||h.def)(o,g.nodes(o.source),g.nodes(o.target),this.contexts.edges,T)}if(x){h=sigma.canvas.edges.labels;for(r=l;r<a;r++){o=c[r];if(!o.hidden)(h[o.type||this.settings(t,"defaultEdgeType")]||h.def)(o,g.nodes(o.source),g.nodes(o.target),this.contexts.labels,T)}}this.contexts.edges.globalCompositeOperation=v;if(a===c.length){delete this.jobs[u];return false}l=a+1;a=Math.min(c.length,l+d);return true};this.jobs[u]=f;conrad.addJob(u,f.bind(this))}else{h=sigma.canvas.edges;for(n=this.edgesOnScreen,r=0,s=n.length;r<s;r++){o=n[r];(h[o.type||this.settings(t,"defaultEdgeType")]||h.def)(o,g.nodes(o.source),g.nodes(o.target),this.contexts.edges,T)}if(x){h=sigma.canvas.edges.labels;for(n=this.edgesOnScreen,r=0,s=n.length;r<s;r++)if(!n[r].hidden)(h[n[r].type||this.settings(t,"defaultEdgeType")]||h.def)(n[r],g.nodes(n[r].source),g.nodes(n[r].target),this.contexts.labels,T)}}}if(E){h=sigma.canvas.nodes;for(n=this.nodesOnScreen,r=0,s=n.length;r<s;r++)if(!n[r].hidden)(h[n[r].type||this.settings(t,"defaultNodeType")]||h.def)(n[r],this.contexts.nodes,T)}if(S){h=sigma.canvas.labels;for(n=this.nodesOnScreen,r=0,s=n.length;r<s;r++)if(!n[r].hidden)(h[n[r].type||this.settings(t,"defaultNodeType")]||h.def)(n[r],this.contexts.labels,T)}this.dispatchEvent("render");return this};sigma.renderers.canvas.prototype.initDOM=function(e,t){var n=document.createElement(e);n.style.position="absolute";n.setAttribute("class","sigma-"+t);this.domElements[t]=n;this.container.appendChild(n);if(e.toLowerCase()==="canvas")this.contexts[t]=n.getContext("2d")};sigma.renderers.canvas.prototype.resize=function(t,n){var r,i=this.width,s=this.height,o=1;if(t!==e&&n!==e){this.width=t;this.height=n}else{this.width=this.container.offsetWidth;this.height=this.container.offsetHeight;t=this.width;n=this.height}if(i!==this.width||s!==this.height){for(r in this.domElements){this.domElements[r].style.width=t+"px";this.domElements[r].style.height=n+"px";if(this.domElements[r].tagName.toLowerCase()==="canvas"){this.domElements[r].setAttribute("width",t*o+"px");this.domElements[r].setAttribute("height",n*o+"px");if(o!==1)this.contexts[r].scale(o,o)}}}return this};sigma.renderers.canvas.prototype.clear=function(){var e;for(e in this.domElements)if(this.domElements[e].tagName==="CANVAS")this.domElements[e].width=this.domElements[e].width;return this};sigma.renderers.canvas.prototype.kill=function(){var e,t;while(t=this.captors.pop())t.kill();delete this.captors;for(e in this.domElements){this.domElements[e].parentNode.removeChild(this.domElements[e]);delete this.domElements[e];delete this.contexts[e]}delete this.domElements;delete this.contexts};sigma.utils.pkg("sigma.canvas.nodes");sigma.utils.pkg("sigma.canvas.edges");sigma.utils.pkg("sigma.canvas.labels")}).call(this);(function(e){"use strict";if(typeof sigma==="undefined")throw"sigma is not declared";sigma.utils.pkg("sigma.canvas.labels");sigma.canvas.labels.def=function(e,t,n){var r,i=n("prefix")||"",s=e[i+"size"];if(!e.displayLabel)return;if(s<n("labelThreshold"))return;if(typeof e.label!=="string")return;r=n("labelSize")==="fixed"?n("defaultLabelSize"):n("labelSizeRatio")*s;t.font=(n("fontStyle")?n("fontStyle")+" ":"")+r+"px "+n("font");t.fillStyle=n("labelColor")==="selected"?e.colorLabel||n("selectedLabelColor"):n("defaultLabelColor");t.fillText(e.label,Math.round(e[i+"x"]+s+3),Math.round(e[i+"y"]+r/3))}}).call(this);(function(){"use strict";sigma.utils.pkg("sigma.canvas.nodes");sigma.canvas.nodes.def=function(e,t,n){var r=n("prefix")||"";t.fillStyle=e.color||n("defaultNodeColor");t.beginPath();t.arc(e[r+"x"],e[r+"y"],e[r+"size"],0,Math.PI*2,true);t.closePath();t.fill();if(!e.attributes.hasOwnProperty("Data")){t.fillStyle=n("defaultBackgroundColor");t.beginPath();t.arc(e[r+"x"],e[r+"y"],e[r+"size"]*.7,0,Math.PI*2,true);t.closePath();t.fill()}}})();(function(){"use strict";sigma.utils.pkg("sigma.canvas.edges");sigma.canvas.edges.def=function(e,t,n,r,i){var s=e.color,o=i("prefix")||"",u=e[o+"size"]||1,a=i("edgeColor"),f=i("defaultNodeColor"),l=i("defaultEdgeColor");if(!s)switch(a){case"source":s=t.color||f;break;case"target":s=n.color||f;break;default:s=l;break}r.strokeStyle=s;r.lineWidth=u;r.beginPath();r.moveTo(t[o+"x"],t[o+"y"]);r.lineTo(n[o+"x"],n[o+"y"]);r.stroke()}})();(function(e){"use strict";if(typeof sigma==="undefined")throw"sigma is not declared";sigma.utils.pkg("sigma.middlewares");sigma.utils.pkg("sigma.utils");sigma.middlewares.rescale=function(e,t,n){var r,i,s,o,u,a,f,l,c=this.graph.nodes(),h=this.graph.edges(),p=this.settings.embedObjects(n||{}),d=p("bounds")||sigma.utils.getBoundaries(this.graph,e,true),v=d.minX,m=d.minY,g=d.maxX,y=d.maxY,b=d.sizeMax,w=d.weightMax,E=p("width")||1,S=p("height")||1,x=p("autoRescale"),T={nodePosition:1,nodeSize:1,edgeSize:1};if(!(x instanceof Array))x=["nodePosition","nodeSize","edgeSize"];for(r=0,i=x.length;r<i;r++)if(!T[x[r]])throw new Error('The rescale setting "'+x[r]+'" is not recognized.');var N=~x.indexOf("nodePosition"),C=~x.indexOf("nodeSize"),k=~x.indexOf("edgeSize");f=p("scalingMode")==="outside"?Math.max(E/Math.max(g-v,1),S/Math.max(y-m,1)):Math.min(E/Math.max(g-v,1),S/Math.max(y-m,1));l=(p("rescaleIgnoreSize")?0:(p("maxNodeSize")||b)/f)+(p("sideMargin")||0);g+=l;v-=l;y+=l;m-=l;f=p("scalingMode")==="outside"?Math.max(E/Math.max(g-v,1),S/Math.max(y-m,1)):Math.min(E/Math.max(g-v,1),S/Math.max(y-m,1));if(!p("maxNodeSize")&&!p("minNodeSize")){s=1;o=0}else if(p("maxNodeSize")===p("minNodeSize")){s=0;o=+p("maxNodeSize")}else{s=(p("maxNodeSize")-p("minNodeSize"))/b;o=+p("minNodeSize")}if(!p("maxEdgeSize")&&!p("minEdgeSize")){u=1;a=0}else if(p("maxEdgeSize")===p("minEdgeSize")){u=0;a=+p("minEdgeSize")}else{u=(p("maxEdgeSize")-p("minEdgeSize"))/w;a=+p("minEdgeSize")}for(r=0,i=h.length;r<i;r++)h[r][t+"size"]=h[r][e+"size"]*(k?u:1)+(k?a:0);for(r=0,i=c.length;r<i;r++){c[r][t+"size"]=c[r][e+"size"]*(C?s:1)+(C?o:0);c[r][t+"x"]=(c[r][e+"x"]-(g+v)/2)*(N?f:1);c[r][t+"y"]=(c[r][e+"y"]-(y+m)/2)*(N?f:1)}};sigma.utils.getBoundaries=function(e,t,n){var r,i,s=e.edges(),o=e.nodes(),u=-Infinity,a=-Infinity,f=Infinity,l=Infinity,c=-Infinity,h=-Infinity;if(n)for(r=0,i=s.length;r<i;r++)u=Math.max(s[r][t+"size"],u);for(r=0,i=o.length;r<i;r++){a=Math.max(o[r][t+"size"],a);c=Math.max(o[r][t+"x"],c);f=Math.min(o[r][t+"x"],f);h=Math.max(o[r][t+"y"],h);l=Math.min(o[r][t+"y"],l)}u=u||1;a=a||1;return{weightMax:u,sizeMax:a,minX:f,minY:l,maxX:c,maxY:h}}}).call(this);(function(e){"use strict";if(typeof sigma==="undefined")throw"sigma is not declared";sigma.utils.pkg("sigma.middlewares");sigma.middlewares.copy=function(e,t){var n,r,i;if(t+""===e+"")return;i=this.graph.nodes();for(n=0,r=i.length;n<r;n++){i[n][t+"x"]=i[n][e+"x"];i[n][t+"y"]=i[n][e+"y"];i[n][t+"size"]=i[n][e+"size"]}i=this.graph.edges();for(n=0,r=i.length;n<r;n++)i[n][t+"size"]=i[n][e+"size"]}}).call(this);(function(e){"use strict";if(typeof sigma==="undefined")throw"sigma is not declared";sigma.utils.pkg("sigma.misc.animation.running");var t=function(){var e=0;return function(){return""+ ++e}}();sigma.misc.animation.camera=function(n,r,i){if(!(n instanceof sigma.classes.camera)||typeof r!=="object"||!r)throw"animation.camera: Wrong arguments.";if(typeof r.x!=="number"&&typeof r.y!=="number"&&typeof r.ratio!=="number"&&typeof r.angle!=="number")throw"There must be at least one valid coordinate in the given val.";var s,o,u,a,f,l,c=i||{},h=sigma.utils.dateNow();l={x:n.x,y:n.y,ratio:n.ratio,angle:n.angle};f=c.duration;a=typeof c.easing!=="function"?sigma.utils.easings[c.easing||"quadraticInOut"]:c.easing;s=function(){var t,i=c.duration?(sigma.utils.dateNow()-h)/c.duration:1;if(i>=1){n.isAnimated=false;n.goTo({x:r.x!==e?r.x:l.x,y:r.y!==e?r.y:l.y,ratio:r.ratio!==e?r.ratio:l.ratio,angle:r.angle!==e?r.angle:l.angle});cancelAnimationFrame(o);delete sigma.misc.animation.running[o];if(typeof c.onComplete==="function")c.onComplete()}else{t=a(i);n.isAnimated=true;n.goTo({x:r.x!==e?l.x+(r.x-l.x)*t:l.x,y:r.y!==e?l.y+(r.y-l.y)*t:l.y,ratio:r.ratio!==e?l.ratio+(r.ratio-l.ratio)*t:l.ratio,angle:r.angle!==e?l.angle+(r.angle-l.angle)*t:l.angle});if(typeof c.onNewFrame==="function")c.onNewFrame();u.frameId=requestAnimationFrame(s)}};o=t();u={frameId:requestAnimationFrame(s),target:n,type:"camera",options:c,fn:s};sigma.misc.animation.running[o]=u;return o};sigma.misc.animation.kill=function(e){if(arguments.length!==1||typeof e!=="number")throw"animation.kill: Wrong arguments.";var t=sigma.misc.animation.running[e];if(t){cancelAnimationFrame(e);delete sigma.misc.animation.running[t.frameId];if(t.type==="camera")t.target.isAnimated=false;if(typeof (t.options||{}).onComplete==="function")t.options.onComplete()}return this};sigma.misc.animation.killAll=function(e){var t,n,r=0,i=typeof e==="string"?e:null,s=typeof e==="object"?e:null,o=sigma.misc.animation.running;for(n in o)if((!i||o[n].type===i)&&(!s||o[n].target===s)){t=sigma.misc.animation.running[n];cancelAnimationFrame(t.frameId);delete sigma.misc.animation.running[n];if(t.type==="camera")t.target.isAnimated=false;r++;if(typeof (t.options||{}).onComplete==="function")t.options.onComplete()}return r};sigma.misc.animation.has=function(e){var t,n=typeof e==="string"?e:null,r=typeof e==="object"?e:null,i=sigma.misc.animation.running;for(t in i)if((!n||i[t].type===n)&&(!r||i[t].target===r))return true;return false}}).call(this);(function(e){"use strict";if(typeof sigma==="undefined")throw"sigma is not declared";sigma.utils.pkg("sigma.misc");sigma.misc.bindEvents=function(t){function a(e){if(e){i="x"in e.data?e.data.x:i;s="y"in e.data?e.data.y:s}var n,r,o,a,f,l,c,h,p=[],d=i+u.width/2,v=s+u.height/2,m=u.camera.cameraPosition(i,s),g=u.camera.quadtree.point(m.x,m.y);if(g.length)for(n=0,o=g.length;n<o;n++){a=g[n];f=a[t+"x"];l=a[t+"y"];c=a[t+"size"];if(!a.hidden&&d>f-c&&d<f+c&&v>l-c&&v<l+c&&Math.sqrt(Math.pow(d-f,2)+Math.pow(v-l,2))<c){h=false;for(r=0;r<p.length;r++)if(a.size>p[r].size){p.splice(r,0,a);h=true;break}if(!h)p.push(a)}}return p}function f(n){function N(e,t){y=false;for(a=0;a<e.length;a++)if(t.size>e[a].size){e.splice(a,0,t);y=true;break}if(!y)e.push(t)}if(!u.settings("enableEdgeHovering")){return[]}var r=sigma.renderers.canvas&&u instanceof sigma.renderers.canvas;if(!r){throw new Error("The edge events feature is not compatible with the WebGL renderer")}if(n){i="x"in n.data?n.data.x:i;s="y"in n.data?n.data.y:s}var o,a,f,l,c,h,p=u.settings("edgeHoverPrecision"),d,v,m,g={},y,b=[],w=i+u.width/2,E=s+u.height/2,S=u.camera.cameraPosition(i,s),x=[];if(r){var T=u.camera.quadtree.area(u.camera.getRectangle(u.width,u.height));for(l=T,o=0,f=l.length;o<f;o++)g[l[o].id]=l[o]}if(u.camera.edgequadtree!==e){x=u.camera.edgequadtree.point(S.x,S.y)}if(x.length)for(o=0,f=x.length;o<f;o++){c=x[o];d=u.graph.nodes(c.source);v=u.graph.nodes(c.target);h=c[t+"size"]||c["read_"+t+"size"];if(!c.hidden&&!d.hidden&&!v.hidden&&(!r||g[c.source]||g[c.target])&&sigma.utils.getDistance(d[t+"x"],d[t+"y"],w,E)>d[t+"size"]&&sigma.utils.getDistance(v[t+"x"],v[t+"y"],w,E)>v[t+"size"]){if(c.type=="curve"||c.type=="curvedArrow"){if(d.id===v.id){m=sigma.utils.getSelfLoopControlPoints(d[t+"x"],d[t+"y"],d[t+"size"]);if(sigma.utils.isPointOnBezierCurve(w,E,d[t+"x"],d[t+"y"],v[t+"x"],v[t+"y"],m.x1,m.y1,m.x2,m.y2,Math.max(h,p))){N(b,c)}}else{m=sigma.utils.getQuadraticControlPoint(d[t+"x"],d[t+"y"],v[t+"x"],v[t+"y"]);if(sigma.utils.isPointOnQuadraticCurve(w,E,d[t+"x"],d[t+"y"],v[t+"x"],v[t+"y"],m.x,m.y,Math.max(h,p))){N(b,c)}}}else if(sigma.utils.isPointOnSegment(w,E,d[t+"x"],d[t+"y"],v[t+"x"],v[t+"y"],Math.max(h,p))){N(b,c)}}}return b}function l(e){function s(e){if(!u.settings("eventsEnabled"))return;u.dispatchEvent("click",e.data);t=a(e);n=f(e);if(t.length){u.dispatchEvent("clickNode",{node:t[0],captor:e.data});u.dispatchEvent("clickNodes",{node:t,captor:e.data})}else if(n.length){u.dispatchEvent("clickEdge",{edge:n[0],captor:e.data});u.dispatchEvent("clickEdges",{edge:n,captor:e.data})}else u.dispatchEvent("clickStage",{captor:e.data})}function o(e){if(!u.settings("eventsEnabled"))return;u.dispatchEvent("doubleClick",e.data);t=a(e);n=f(e);if(t.length){u.dispatchEvent("doubleClickNode",{node:t[0],captor:e.data});u.dispatchEvent("doubleClickNodes",{node:t,captor:e.data})}else if(n.length){u.dispatchEvent("doubleClickEdge",{edge:n[0],captor:e.data});u.dispatchEvent("doubleClickEdges",{edge:n,captor:e.data})}else u.dispatchEvent("doubleClickStage",{captor:e.data})}function l(e){if(!u.settings("eventsEnabled"))return;u.dispatchEvent("rightClick",e.data);if(t.length){u.dispatchEvent("rightClickNode",{node:t[0],captor:e.data});u.dispatchEvent("rightClickNodes",{node:t,captor:e.data})}else if(n.length){u.dispatchEvent("rightClickEdge",{edge:n[0],captor:e.data});u.dispatchEvent("rightClickEdges",{edge:n,captor:e.data})}else u.dispatchEvent("rightClickStage",{captor:e.data})}function c(e){if(!u.settings("eventsEnabled"))return;var t,n,s,o,a=[],f=[];for(t in r)a.push(r[t]);r={};for(n=0,s=a.length;n<s;n++)u.dispatchEvent("outNode",{node:a[n],captor:e.data});if(a.length)u.dispatchEvent("outNodes",{nodes:a,captor:e.data});i={};for(n=0,s=f.length;n<o;n++)u.dispatchEvent("outEdge",{edge:f[n],captor:e.data});if(a.length)u.dispatchEvent("outEdges",{edges:f,captor:e.data})}function h(e){if(!u.settings("eventsEnabled"))return;t=a(e);n=f(e);var s,o,l,c,h=[],p=[],d={},v=t.length,m=[],g=[],y={},b=n.length;for(s=0;s<v;s++){l=t[s];d[l.id]=l;if(!r[l.id]){p.push(l);r[l.id]=l}}for(o in r)if(!d[o]){h.push(r[o]);delete r[o]}for(s=0,v=p.length;s<v;s++)u.dispatchEvent("overNode",{node:p[s],captor:e.data});for(s=0,v=h.length;s<v;s++)u.dispatchEvent("outNode",{node:h[s],captor:e.data});if(p.length)u.dispatchEvent("overNodes",{nodes:p,captor:e.data});if(h.length)u.dispatchEvent("outNodes",{nodes:h,captor:e.data});for(s=0;s<b;s++){c=n[s];y[c.id]=c;if(!i[c.id]){g.push(c);i[c.id]=c}}for(o in i)if(!y[o]){m.push(i[o]);delete i[o]}for(s=0,b=g.length;s<b;s++)u.dispatchEvent("overEdge",{edge:g[s],captor:e.data});for(s=0,b=m.length;s<b;s++)u.dispatchEvent("outEdge",{edge:m[s],captor:e.data});if(g.length)u.dispatchEvent("overEdges",{edges:g,captor:e.data});if(m.length)u.dispatchEvent("outEdges",{edges:m,captor:e.data})}var t,n,r={},i={};e.bind("click",s);e.bind("mousedown",h);e.bind("mouseup",h);e.bind("mousemove",h);e.bind("mouseout",c);e.bind("doubleclick",o);e.bind("rightclick",l);u.bind("render",h)}var n,r,i,s,o,u=this;for(n=0,r=this.captors.length;n<r;n++)l(this.captors[n])}}).call(this)